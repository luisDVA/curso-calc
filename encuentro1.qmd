---
title: "R para el tratamiento de Hojas de CÃ¡lculo"
subtitle: "Primer encuentro: IntroducciÃ³n y fundamentos"
date: "11/11/2025"
author: "Luis D. Verde Arregoitia"
format:
  revealjs:
    slide-number: true
    theme: css/slides.scss
---

```{r fa packages setup}
#| echo: false
library(fontawesome)
```


## ğŸ‘‹ Â¡Hola!

:::::: columns
::: {.column width="30%"}
![](images/luisbb.jpg){width="80%"}\
[`r fontawesome::fa(name = "github")` \@LuisDVA](https://github.com/luisdva)\
[`r fontawesome::fa(name = "link")` liomys.mx](https://liomys.mx)\
[`r fontawesome::fa(name = "paper-plane")` luis\@liomys.mx](mailto:luis@liomys.mx)
:::

:::: {.column width="70%"}
-   MamÃ­feros, ecologÃ­a, conservaciÃ³n  
-   Instructor certificado - Posit(RStudio) & The Carpentries\
-   mentor rOpenSci 2023-2026
-   Desarrollo de paquetes  
-   Colaborador R-Ladies (St. Louis ğŸ‡ºğŸ‡¸; Buenos Aires ğŸ‡¦ğŸ‡·; Gaborone ğŸ‡§ğŸ‡¼)
::::
::::::

## ğŸ“š Este curso

- TÃ©cnicas eficientes para trabajar con hojas de cÃ¡lculo en R
- Importar y exportar archivos
- Trabajar con mÃºltiples hojas o archivos
- Archivos en la nube (Google Sheets)
- Soluciones a problemas comunes

## ğŸ’» Â¿QuÃ© necesitamos?

### Software

- R v.4.4.0 o mayor
- RStudio 2024.04 o mayor

### Paquetes

:::::: columns
::: {.column width="50%"}
- `readxl`
- `fs`
- `readODS`

:::

::: {.column width="50%"}
- `writexl`
- `dplyr`
- `tidyr`
:::
::::

## ğŸ–¥ï¸ Mi mÃ¡quina

- R versiÃ³n 4.5.2 (2025-10-31)
- Rstudio versiÃ³n 2025.9.2.418
- Linux Mint 22.2

## ğŸ¤– Uso de IA en el curso

. . . 

<br/><br/>

 ğŸ¤  adelante


## Este curso

- TÃ©cnicas eficientes para trabajar con hojas de cÃ¡lculo en R
- Importar y exportar archivos
- Trabajar con mÃºltiples hojas o archivos
- Archivos en la nube (Google Sheets)
- Soluciones a problemas comunes

## Â¿QuÃ© necesitamos?

### Software

- R v.4.4.0 o mayor
- RStudio 2024.04 o mayor

### Paquetes

:::::: columns
::: {.column width="50%"}
- `readxl`
- `fs`
- `readODS`

:::

::: {.column width="50%"}
- `writexl`
- `dplyr`
- `tidyr`
:::
::::

## Mi mÃ¡quina

- R versiÃ³n 4.5.2 (2025-10-31)
- Rstudio versiÃ³n 2025.9.2.418
- Linux Mint 22.2

## ğŸ¤– Uso de IA en el curso

. . . 

<br/><br/>

 ğŸ¤  adelante

# ğŸ“Š Hojas de cÃ¡lculo

## ğŸŒ Hojas de cÃ¡lculo

### En 2018

- \> 800,000,000 usuarios de Excel 
- ~170,000,000 usuarios de Google Sheets 

::::{.rightref}
:::{.refbox}
Rebman et al. ([2023](https://files.eric.ed.gov/fulltext/EJ1409034.pdf))
:::
::::

## 

:::: columns
::: {.column width="50%"}
**VisiCalc** (1979)
![](images/Visicalc.png)
:::

::: {.column width="50%"}
Registro de prÃ©stamos (**1593**)
![](images/rome.jpg){width="50%"}
:::
::::

## El resto es historia

- **Lotus 1-2-3** (1983) 
- **Microsoft Excel** (1985)
- Opciones Open Source

### ColaboraciÃ³n en la nube

- Google Spreadsheets (2006) -> **Google Sheets** (2012)
- Almacenamiento remoto (Dropbox, Drive, OneDrive, etc.)

## Desventajas

:::::: columns
::: {.column width="50%"}

### Conceptuales

- Proceso manual, repetitivo, difÃ­cil de automatizar
- Libertad para crear datos inutilizables
- Errores difÃ­ciles de detectar
:::

:::: {.column width="50%"}

### TÃ©cnicas

- LÃ­mites de filas y columnas
- Poca trazabilidad
- Dificultad para compartir datos entre plataformas

:::
::::::

## âœ… Ventajas

:::::: columns
::: {.column width="50%"}

### Conceptuales

- Interfaz grÃ¡fica intuitiva
- CÃ¡lculos inmediatos y visibles
- Barrera de entrada baja
:::

:::: {.column width="50%"}

### TÃ©cnicas

- Visualizaciones incorporadas
- No hace falta saber programar
- Reactividad para anÃ¡lisis inmediatos
:::
::::::


# ğŸ”„ Flujo de trabajo

## 

<br/><br/>

::: {.big-text}
- Importancia de scripts y cÃ³digo
- Sistemas de archivos & proyectos
- Datos organizados
:::

## ğŸ“ Scripts y cÃ³digo fuente

Trabajando con scripts ordenados, podemos:

:::: columns
::: {.column width="40%"}

![](images/pancks.png){width="80%"}

:::

::: {.column width="60%"}

- Reproducir y modificar pasos
- Encontrar errores
- Documentar el proceso
- Examinar cÃ³digo ajeno

:::
::::

## ğŸ“ Proyectos y sistemas de archivos

![](images/filesdmp.png){fig-align="center"}

## Proyecto

Directorio con todo los archivos relevantes para algÃºn trabajo

### Separar:

ğŸ“ Datos\
ğŸ“ CÃ³digo\
ğŸ“ Salidas (figuras, informes, datos intermedios, etc.)\
  
::::{.rightref}
:::{.refbox}
::: columns
::: {.column width="50%"}
Jenny Bryan (2017)\
[Project-oriented workflow](https://www.tidyverse.org/blog/2017/12/workflow-vs-script/)
:::

::: {.column width="50%"}
MaÃ«lle Salmon (2021)\
[Draw me a project](https://masalmon.eu/2021/06/30/r-projects/)
:::
:::
:::
::::


## 

![](images/ubereats.png){fig-align="center"}

## âœï¸ Ejercicio - Proyecto para el curso {background="#fff0f3"} 

Es momento de crear un proyecto o carpeta para este curso:

<br/>
- Manualmente o desde RStudio  
- UbicaciÃ³n accesible  
- Evitar OneDrive  
- Descargar archivos y descomprimir

## ğŸ“Š OrganizaciÃ³n de datos

![](images/bromanwoo.png){fig-align="center"}

::::{.rightref}
:::{.refbox}
Broman & Woo (2018)  
[Data Organization in Spreadsheets](https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1375989)
:::
::::

## Recomendaciones

:::: columns
::: {.column width="20%"}
![](images/tetris.png)
:::

::: {.column width="80%"}
- Una sola fila para encabezados
- No combinar celdas
- Evitar espacios en blanco como separadores o decoraciÃ³n
- Evitar notas en celdas de datos  
- No almacenar informaciÃ³n en el formato
:::
::::


## ğŸ“¦ `fs`

### Trabajando con el sistema de archivos

`fs` trabaja con rutas que siempre funcionan en cualquier plataforma. Sirve para:

<br/>

Crear directorios\
Mover archivos\
Copiar archivos\
Cambiar nombres

## âœï¸ Ejercicio - Sistema de Archivos {background="#fff0f3"} 

Carguemos el paquete `fs` y exploremos los archivos proporcionados

```{r}
#| eval: false
#| echo: true

library(fs)
dir_ls("mi_proyecto/datos/")

```

# ğŸ“¥ Importando hojas de cÃ¡lculo a R

## ğŸ“‹ Formatos Comunes

### xls

Excel 2003 - Archivo binario, patentado por Microsoft. Permite macros.

### xlsx

Excel 2007 en adelante - Formato XML. Con compresiÃ³n. No permite macros. Almacena mÃ¡s filas y columnas que `.xls`.

### ods

OpenOffice, StarOffice & LibreOffice - Formato XML libre similar a xlsx. Licencia CC.

## Paquetes para importar datos

`readxl` y `readODS`

```{r}
#| eval: false
#| echo: true
library(readxl)
library(readODS)

read_excel("archivo.xlsx")
read_ods("archivo.ods")
```

## Importando datos

### Argumentos Ãºtiles

- `sheet`
- `skip`
- `trim_ws`

<br/>

Probemos el script `importar.R`

## Importando datos

Podemos importar hojas por nombre o por posiciÃ³n

```{r}
#| eval: false
#| echo: true

excel_sheets("archivo.xlsx")

ruta <- "archivo.xlsx"

ruta |> 
  read_excel(sheet = "nombre de la primer hoja")
ruta |> 
  read_excel(sheet = 1)
```

## Libros de trabajo vs dataframes

:::::: columns
::: {.column width="48%"}
### Libro de trabajo
- MÃºltiples hojas
- Celdas con fÃ³rmulas
- Formato (colores, bordes)
- Mezcla de datos y anÃ¡lisis
:::

:::: {.column width="4%"}
:::

:::: {.column width="48%"}
### data frame
- Rectangular
- En memoria
- Operaciones programÃ¡ticas
- SeparaciÃ³n de datos y anÃ¡lisis
:::
::::::

## 

### Ventajas de usar R con hojas de cÃ¡lculo

- AutomatizaciÃ³n de tareas repetitivas
- Reproducibilidad del anÃ¡lisis
- Manejo de grandes volÃºmenes de datos
- DocumentaciÃ³n del proceso
- Control de versiones del cÃ³digo
- Herramientas estadÃ­sticas avanzadas

## ğŸ”œ PrÃ³ximo encuentro

- Exploraremos listas e iteraciÃ³n para trabajar con mÃºltiples archivos
- Aprenderemos operaciones comunes de manipulaciÃ³n
- Veremos cÃ³mo exportar objetos de R a hojas de cÃ¡lculo

