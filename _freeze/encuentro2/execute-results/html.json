{
  "hash": "23a948da97900fa967af7de1b7818464",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R para el tratamiento de Hojas de C치lculo\"\nsubtitle: \"Segundo encuentro: Listas, iteraci칩n y c칩mo exportar tablas\"\ndate: \"11/18/2025\"\nauthor: \"Luis D. Verde Arregoitia\"\nformat:\n  revealjs:\n    slide-number: true\n    theme: css/slides.scss\neditor: visual\n---\n\n## Resumen del encuentro anterior\n\n- Buenas pr치cticas para organizar datos\n- Fundamentos de hojas de c치lculo\n- Importando archivos \n\n## Hoy\n\n- Listas & iteraci칩n para trabajar con m칰ltiples archivos\n- Operaciones comunes de manipulaci칩n de datos\n- Exportar objetos de R a hojas de c치lculo\n\n## Hoy\n\nPaquetes para el encuentro\n\n- `purrr`\n- `dplyr`\n- `writexl`\n- `fs`\n\n# Listas & iteraci칩n\n\n## Listas en R\n\nLas listas son estructuras de datos vers치tiles que pueden guardar objetos de clases diferentes:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Crear una lista con diferentes tipos de datos\nmi_lista <- list(\n  numeros = 1:5,\n  texto = \"Estaci칩n R\",\n  logico = c(TRUE,TRUE,FALSE,TRUE),\n  data = data.frame(x = 1:3, y = c(\"a\", \"b\", \"c\"))\n)\n```\n:::\n\n\n\n##\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmi_lista\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$numeros\n[1] 1 2 3 4 5\n\n$texto\n[1] \"Estaci칩n R\"\n\n$logico\n[1]  TRUE  TRUE FALSE  TRUE\n\n$data\n  x y\n1 1 a\n2 2 b\n3 3 c\n```\n\n\n:::\n:::\n\n\n## Accedediendo a los elementos de la lista\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmi_lista$numeros\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1 2 3 4 5\n```\n\n\n:::\n\n```{.r .cell-code}\nmi_lista[[\"texto\"]]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Estaci칩n R\"\n```\n\n\n:::\n\n```{.r .cell-code}\nmi_lista[[4]]  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  x y\n1 1 a\n2 2 b\n3 3 c\n```\n\n\n:::\n:::\n\n\n## Listas + hojas de c치lculo\n\n- Almacenar m칰ltiples dataframes derivados de pesta침as/hojas\n- Trabajar con m칰ltiples archivos en simult치neo\n- Cada elemento de una lista puede tener nombre\n\n## Ejercicio - Lista de tablas {background=\"#fff0f3\"} \n\nCon el archivo `cafeteria.xlsx`:  \n\n- Crear una lista con un elemento (data frame) para cada una de las dos primeras hojas (Bebidas y Panader칤a)\n- Crear una carpeta nueva para salidas con `fs`\n- Exportar cada elemento de la lista a un archivo de texto plano\n\n\n## De data frame a archivo xlsx\n\nEl paquete `writexl` permite exportar data frames o listas de data frames a plantillas xlsx\n\n<br/>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(writexl)\nwritexl::write_xlsx(x= \"mi_tabla\",\n                    path=\"mipantilla.xlsx\")\n```\n:::\n\n\n## `writexl`\n\nSi usamos listas (incluso listas de longitud 1) los nombres de los elementos se usan como nombres de las pesta침as/hojas\n\n<br/>\n\n`write_xlsx(x=list(mi_hoja = mi_tabla))`\n\n## Ejercicio - Exportando {background=\"#fff0f3\"}\n\n- Exportar cada elemento de la lista a su propio archivo xlsx\n- Exportar la lista a un solo archivo con nombres para cada pesta침a\n- 쮺칩mo cambiar칤amos los nombres de las pesta침as?\n\n## Aplicando una funci칩n varias veces\n\nCopiar/pegar c칩digo para editarlo en an치lisis repetitivos agrega pasos innecesarios, pierde tiempo, y aumenta el riesgo de introducir errores \n\n## Aplicando funciones a m칰ltiples elementos\n\nPara: cada elemento de **x**  \nAplicar la funci칩n **f**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfor (x in 1:7){\n  print(x)\n} \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1\n[1] 2\n[1] 3\n[1] 4\n[1] 5\n[1] 6\n[1] 7\n```\n\n\n:::\n:::\n\n\n## \n\n`x` puede ser una lista o vector de rutas, y `f` una funci칩n para leer archivos\n\n<br/>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(purrr)\nlibrary(fs)\narchivos_csv <- dir_ls(glob = \"*.csv\")\ntodos <- map(archivos_csv, read.csv)\n```\n:::\n\n\n\n## purrr?\n\n::: columns\n::: {.column width=\"25%\"}\n![](images/purrr.jpeg)\n:::\n\n::: {.column width=\"75%\"}\n游닍 **`purrr`** - Herramientas para programaci칩n funcional\n\n-   funciones `map` que aplican una funci칩n a cada elemento de una lista o vector y devuelve un resultado de la misma longitud que la entrada\n\n-   trabaja bien con **listas**\n-   c칩digo legible y conciso\n:::\n:::\n\n::::{.rightref}\n:::{.refbox}\nThomas Mock (2018)\\\n[Functional Programming in R with purrr](https://towardsdatascience.com/functional-programming-in-r-with-purrr-469e597d0229)\n:::\n:::\n\n\n## Ejercicio - purrr para m칰ltiples archivos CSV {background=\"#fff0f3\"}\n\n- Usa el c칩digo de hace dos diapositivas para importar los archivos csv generados en el ejercicio anterior usando la funci칩n `map` de `purrr`.\n\n- Combinemos las tablas en una sola\n\n## Importando m칰ltiples pesta침as \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Leer todas las pesta침as de un archivo Excel\nlibrary(readxl)\npestanas <- excel_sheets(\"ejemplos/cafeteria.xlsx\")\npestanas\n# purrr\nlibrary(purrr)\nmap(pestanas, \\(x) read_excel(\"ejemplos/cafeteria.xlsx\", sheet = x))\n```\n:::\n\n\n> 쮺칩mo acotamos el proceso a las dos primeras hojas?\n\n## Funciones an칩nimas, notaci칩n actual\n\n**Funciones para llevar** (se crean y se ejecutan pero nunca se asignan a un objeto con nombre)\n\n### Sintaxis\n\n:::{.big-code}\n\n::: {.cell}\n\n```{.r .cell-code}\n(\\(x) x + 3)(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 13\n```\n\n\n:::\n:::\n\n:::\n\nLa definici칩n va entre par칠ntesis para separar la funci칩n de sus argumentos\n\n##\n\n\n`map(pestanas, \\(x) read_excel(\"ejemplos/cafeteria.xlsx\", sheet = x))`\n\n<br/>\n\nequivale a \n\n`read_excel(\"ejemplos/cafeteria.xlslx\", sheet=\"Bebidas\")` luego  \n`read_excel(\"ejemplos/cafeteria.xlslx\", sheet=\"Panaderia\")`  etc...\n\n## Datos agrupados\n\nLa mayor칤a de nuestras tareas se pueden desarrollar siguiendo el paradigma \"_dividir - aplicar - combinar_\" (\n[\"split-apply-combine\"]{style=\"color: purple\"}):\n\n- dividir los datos en grupos\n- aplicar alguna funci칩n a cada grupo\n- combinar los resultados\n\n::::{.rightref}\n:::{.refbox}\nData Carpentry (2018)\\\n[Aggregating and analyzing data with dplyr](https://datacarpentry.org/R-genomics/04-dplyr.html)\n\nHadley Wickham (2011)\\\n[The split-apply-combine strategy for data analysis](https://doi.org/10.18637/jss.v040.i01)\n:::\n::::\n\n## `dplyr::group_by()`\n\n- Define grupos seg칰n una o m치s variables  \n- Estratifica un data frame  \n- equivalente a `aggregate()` y al argumento '`by =`' de `data.table`\n\n![Manipulaci칩n de datos en R con dplyr - Rub칠n S치nchez](images/groupby.PNG){width=\"64%\"}\n\n\n## Trabajando con datos agrupados\n\nCon la versi칩n agrupada de nuestra tabla, las funciones de `dplyr` trabajan sobre cada grupo por separado y despu칠s se combinan los resultados.\n\n</br>\n\n::::{.rightref}\n:::{.refbox}\nRStudio (2021)\\\n[Data transformation with dplyr cheatsheet](https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-transformation.pdf)\n:::\n:::\n\n## Opciones para datos agrupados\n\n- resumir valores (media, mediana, etc. por grupo)\n- extraer las primeras o 칰ltimas _n_ filas por grupo\n- identificar valores m치ximos o m칤nimos\n- eliminar filas repetidas\n- contar observaciones, etc.\n\n\n## Dividir datos en pesta침as o archivos separados\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dividir un dataframe por una variable categ칩rica\nchatarra <- read_excel(\"ejemplos/fastfood.xls\")\nchatarra |> group_by(restaurant) |> group_split()\n```\n:::\n\n\n\n## Para el pr칩ximo encuentro...\n\n- Trabajaremos con archivos en la nube (Google Sheets)\n- Aprenderemos a conectarnos con la API de Google\n- Veremos c칩mo trabajar con formato en celdas o texto\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}