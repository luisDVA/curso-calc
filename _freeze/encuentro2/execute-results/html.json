{
  "hash": "c331fa2fdd71afc81a5fefe22cf09fce",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R para el tratamiento de Hojas de Cálculo\"\nsubtitle: \"Segundo encuentro: Listas, iteración y exportación\"\ndate: \"18 de Noviembre, 2025\"\nauthor: \"Luis D. Verde Arregoitia\"\nformat:\n  revealjs:\n    slide-number: true\n    theme: css/slides.scss\neditor: visual\n---\n\n## Resumen del encuentro anterior\n\n- Buenas prácticas para organizar datos\n- Fundamentos de hojas de cálculo\n- Importación básica de archivos Excel y CSV\n\n## Listas en R\n\nLas listas son estructuras de datos versátiles que pueden contener diferentes tipos de objetos:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Crear una lista con diferentes tipos de datos\nmi_lista <- list(\n  numeros = 1:5,\n  texto = \"Hoja de cálculo\",\n  logico = TRUE,\n  data = data.frame(x = 1:3, y = c(\"a\", \"b\", \"c\"))\n)\n\n# Acceder a elementos de la lista\nmi_lista$numeros\nmi_lista[[\"texto\"]]\nmi_lista[[3]]  # Elemento logico\n```\n:::\n\n\n## ¿Por qué usar listas con hojas de cálculo?\n\n- Almacenar múltiples dataframes (pestañas de Excel)\n- Mantener metadatos junto con los datos\n- Organizar resultados de operaciones sobre múltiples archivos\n- Preservar la estructura de archivos Excel con múltiples hojas\n\n## Iteración: Aplicando funciones a múltiples elementos\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Usando lapply para aplicar una función a cada elemento de una lista\narchivos_csv <- list.files(pattern = \"*.csv\")\ndatos_lista <- lapply(archivos_csv, read.csv)\n\n# Usando un bucle for\ndatos_lista2 <- list()\nfor (archivo in archivos_csv) {\n  datos_lista2[[archivo]] <- read.csv(archivo)\n}\n```\n:::\n\n\n## Trabajo con el sistema de archivos desde R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Listar archivos\narchivos <- list.files()\narchivos_excel <- list.files(pattern = \"*.xlsx\")\n\n# Comprobar si un archivo existe\nfile.exists(\"datos.xlsx\")\n\n# Obtener información de un archivo\nfile.info(\"datos.xlsx\")\n\n# Crear un directorio\ndir.create(\"resultados\")\n```\n:::\n\n\n## Importación de múltiples archivos o pestañas\n\n### Múltiples archivos CSV\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtener lista de archivos CSV en un directorio\narchivos_csv <- list.files(path = \"datos\", \n                          pattern = \"*.csv\", \n                          full.names = TRUE)\n\n# Leer todos los archivos y combinarlos\nlibrary(tidyverse)\ndatos_combinados <- archivos_csv %>%\n  map_df(read_csv, .id = \"archivo\")\n```\n:::\n\n\n## Importación de múltiples pestañas de Excel\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Leer todas las pestañas de un archivo Excel\nlibrary(readxl)\npestanas <- excel_sheets(\"archivo.xlsx\")\n\n# Método 1: Usar lapply\ndatos_pestanas <- lapply(pestanas, function(sheet) {\n  read_excel(\"archivo.xlsx\", sheet = sheet)\n})\nnames(datos_pestanas) <- pestanas\n\n# Método 2: Usando purrr\nlibrary(purrr)\ndatos_pestanas2 <- pestanas %>%\n  set_names() %>%\n  map(~read_excel(\"archivo.xlsx\", sheet = .x))\n```\n:::\n\n\n## Dividir datos en pestañas o archivos separados\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dividir un dataframe por una variable categórica\nlibrary(dplyr)\ndatos_divididos <- split(datos, datos$categoria)\n\n# Guardar cada grupo como un archivo CSV separado\nfor (nombre in names(datos_divididos)) {\n  write.csv(datos_divididos[[nombre]], \n            paste0(\"grupo_\", nombre, \".csv\"),\n            row.names = FALSE)\n}\n```\n:::\n\n\n## Operaciones comunes con dataframes\n\n:::: columns\n::: {.column width=\"50%\"}\n### Ordenar filas\n\n::: {.cell}\n\n```{.r .cell-code}\n# Base R\ndatos[order(datos$fecha), ]\n\n# dplyr\ndatos %>% arrange(fecha)\ndatos %>% arrange(desc(ventas))\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n### Reacomodar columnas\n\n::: {.cell}\n\n```{.r .cell-code}\n# Seleccionar columnas específicas\ndatos %>% select(id, nombre, valor)\n\n# Reordenar todas las columnas\ndatos %>% select(fecha, id, everything())\n```\n:::\n\n:::\n::::\n\n## Operaciones comunes (continuación)\n\n:::: columns\n::: {.column width=\"50%\"}\n### Subconjuntos de datos\n\n::: {.cell}\n\n```{.r .cell-code}\n# Base R\ndatos[datos$ventas > 1000, ]\n\n# dplyr\ndatos %>% filter(ventas > 1000)\ndatos %>% filter(region == \"Norte\", \n                año == 2025)\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n### Filtros\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filtrar datos faltantes\ndatos %>% filter(!is.na(ventas))\n\n# Filtrar por patrón en texto\ndatos %>% \n  filter(str_detect(producto, \"Excel\"))\n```\n:::\n\n:::\n::::\n\n## Exportando objetos de R a hojas de cálculo\n\n### Archivos CSV\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Base R\nwrite.csv(datos, \"resultados.csv\", row.names = FALSE)\n\n# readr (tidyverse)\nwrite_csv(datos, \"resultados.csv\")\n```\n:::\n\n\n### Archivos Excel (con openxlsx)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(openxlsx)\n\n# Crear un libro de trabajo\nwb <- createWorkbook()\n\n# Agregar una hoja\naddWorksheet(wb, \"Datos\")\nwriteData(wb, \"Datos\", datos)\n\n# Guardar el libro\nsaveWorkbook(wb, \"resultados.xlsx\", overwrite = TRUE)\n```\n:::\n\n\n## Exportando múltiples dataframes a Excel\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lista de dataframes\nlista_datos <- list(\n  Ventas = datos_ventas,\n  Clientes = datos_clientes,\n  Productos = datos_productos\n)\n\n# Crear un libro con múltiples hojas\nwb <- createWorkbook()\n\n# Agregar cada dataframe como una hoja\nfor (nombre in names(lista_datos)) {\n  addWorksheet(wb, nombre)\n  writeData(wb, nombre, lista_datos[[nombre]])\n}\n\n# Guardar el libro\nsaveWorkbook(wb, \"informe_completo.xlsx\")\n```\n:::\n\n\n## Añadiendo formato a las hojas exportadas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Crear estilos\nestilo_encabezado <- createStyle(\n  fontSize = 12, textDecoration = \"bold\",\n  fgFill = \"#8BC34A\", fontColour = \"white\"\n)\n\nestilo_numero <- createStyle(numFmt = \"#,##0.00\")\n\n# Aplicar estilos\naddWorksheet(wb, \"Datos\")\nwriteData(wb, \"Datos\", datos)\n\n# Aplicar estilo a encabezados\naddStyle(wb, \"Datos\", estilo_encabezado, \n         rows = 1, cols = 1:ncol(datos))\n\n# Aplicar estilo a columnas numéricas\naddStyle(wb, \"Datos\", estilo_numero, \n         cols = c(3, 5), rows = 2:(nrow(datos) + 1))\n```\n:::\n\n\n## Para el próximo encuentro...\n\n- Trabajaremos con archivos en la nube (Google Sheets)\n- Aprenderemos a conectarnos con la API de Google\n- Veremos cómo trabajar con formato en celdas o texto\n\n### Ejercicio sugerido\nPractiquen importar múltiples hojas de Excel y exportar los resultados con formato básico.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}